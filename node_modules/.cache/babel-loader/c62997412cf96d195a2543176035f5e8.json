{"ast":null,"code":"import _slicedToArray from\"D:/MyProjects/Technomoles/LeisureGuruFE/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState,useRef}from\"react\";import Header from\"./Header\";import{useNavigate}from\"react-router-dom\";import LoadingSpinner from\"./LoadingSpinner\";import'whatwg-fetch';import{Alert,Form,FormFeedback,FormGroup,Input,Label}from\"reactstrap\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var Login=function Login(){var _useState=useState(''),_useState2=_slicedToArray(_useState,2),password=_useState2[0],setPassword=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),email=_useState4[0],setEmail=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),dirtyEmail=_useState6[0],setDirtyEmail=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),dirtyPassword=_useState8[0],setDirtyPassword=_useState8[1];var _useState9=useState('Field can`t be empty'),_useState10=_slicedToArray(_useState9,2),errorEmail=_useState10[0],setErrorEmail=_useState10[1];var _useState11=useState('Field can`t be empty'),_useState12=_slicedToArray(_useState11,2),errorPassword=_useState12[0],setErrorPassword=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),formValid=_useState14[0],setFormValid=_useState14[1];var _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),isLoading=_useState16[0],setIsLoading=_useState16[1];var fieldEmail=useRef();var _useState17=useState(''),_useState18=_slicedToArray(_useState17,2),serverError=_useState18[0],setServerError=_useState18[1];var navigate=useNavigate();useEffect(function(){if(errorEmail||errorPassword){setFormValid(false);}else{setFormValid(true);}},[errorEmail,errorPassword]);var emailHandler=function emailHandler(e){setDirtyEmail(true);setEmail(e.target.value);var re=/^(([^<>()[\\]\\.,;:\\s@\\\"]+(\\.[^<>()[\\]\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@(([^<>()[\\]\\.,;:\\s@\\\"]+\\.)+[^<>()[\\]\\.,;:\\s@\\\"]{2,})$/i;if(!e.target.value){setErrorEmail('Field can`t be empty');}else if(!re.test(String(e.target.value).toLowerCase())){setErrorEmail('Incorrect email');}else{setErrorEmail(\"\");}};var passwordHandler=function passwordHandler(e){setDirtyPassword(true);setPassword(e.target.value);localStorage.setItem(\"password\",e.target.value);if(e.target.value.length<5){setErrorPassword('Make it more than 5');if(!e.target.value){setErrorPassword('Field can`t be empty');}}else{setErrorPassword(\"\");}};var handleSubmit=function handleSubmit(event){//Prevent page reload\nevent.preventDefault();setIsLoading(true);fetch('http://127.0.0.1:5000/login',{method:'PUT',headers:{'Content-Type':'application/json'},body:JSON.stringify({email:email,password:password})}).catch(function(e){throw new Error('Service unreachable');}).then(function(response){if(response.headers.get('content-type')=='application/json'){return response.json();}else{throw new Error(response.statusText);}}).then(function(jsonResponse){if(jsonResponse.code>=300){throw new Error(jsonResponse.message);}else{localStorage.setItem(\"id\",jsonResponse.id);localStorage.setItem(\"email\",jsonResponse.email);setIsLoading(false);navigate(\"/homepage\");}}).catch(function(e){setIsLoading(false);setServerError(e.message);});};var renderForm=/*#__PURE__*/_jsx(\"div\",{className:\"form\",children:/*#__PURE__*/_jsxs(Form,{className:\"form-body\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(FormGroup,{className:\"form__element\",children:[/*#__PURE__*/_jsx(Label,{className:\"form__label\",children:\"Email\"}),/*#__PURE__*/_jsx(Input,{invalid:dirtyEmail&&errorEmail,onChange:function onChange(e){return emailHandler(e);},onBlur:function onBlur(e){return emailHandler(e);},type:\"text\",className:\"form__input\",placeholder:\"Email\",name:\"email\",required:true,ref:fieldEmail}),/*#__PURE__*/_jsx(FormFeedback,{invalid:true,style:{width:'30%'},children:errorEmail})]}),/*#__PURE__*/_jsxs(FormGroup,{className:\"form__element\",children:[/*#__PURE__*/_jsx(Label,{className:\"form__label\",children:\"Password \"}),/*#__PURE__*/_jsx(Input,{invalid:dirtyPassword&&errorPassword,onChange:function onChange(e){return passwordHandler(e);},onBlur:function onBlur(e){return passwordHandler(e);},type:\"password\",className:\"form__input\",placeholder:\"Password\",name:\"pass\",required:true}),/*#__PURE__*/_jsx(FormFeedback,{invalid:true,style:{width:'30%'},children:errorPassword})]}),/*#__PURE__*/_jsx(\"div\",{className:\"submitDiv\",children:/*#__PURE__*/_jsx(\"button\",{disabled:!formValid||isLoading,className:\"submitButton\",type:\"submit\",children:\"Login\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"formError\",children:serverError==''?null:/*#__PURE__*/_jsx(Alert,{color:\"danger\",style:{width:\"100%\"},children:serverError})})]})});return/*#__PURE__*/_jsx(\"div\",{className:\"Login\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"login-form\",children:[/*#__PURE__*/_jsx(\"div\",{children:Header(\"Log in\")}),isLoading?/*#__PURE__*/_jsx(LoadingSpinner,{}):renderForm]})});};","map":{"version":3,"names":["React","useEffect","useState","useRef","Header","useNavigate","LoadingSpinner","Alert","Form","FormFeedback","FormGroup","Input","Label","Login","password","setPassword","email","setEmail","dirtyEmail","setDirtyEmail","dirtyPassword","setDirtyPassword","errorEmail","setErrorEmail","errorPassword","setErrorPassword","formValid","setFormValid","isLoading","setIsLoading","fieldEmail","serverError","setServerError","navigate","emailHandler","e","target","value","re","test","String","toLowerCase","passwordHandler","localStorage","setItem","length","handleSubmit","event","preventDefault","fetch","method","headers","body","JSON","stringify","catch","Error","then","response","get","json","statusText","jsonResponse","code","message","id","renderForm","width"],"sources":["D:/MyProjects/Technomoles/LeisureGuruFE/src/components/Login.js"],"sourcesContent":["import React, {useEffect, useState, useRef } from \"react\";\r\nimport Header from \"./Header\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport LoadingSpinner from \"./LoadingSpinner\";\r\nimport 'whatwg-fetch';\r\nimport { Alert, Form, FormFeedback, FormGroup, Input, Label } from \"reactstrap\";\r\n\r\nexport const Login = function() {\r\n  const[password, setPassword] = useState('')\r\n  const[email, setEmail] = useState('')\r\n  const[dirtyEmail, setDirtyEmail] = useState(false)\r\n  const[dirtyPassword, setDirtyPassword] = useState(false)\r\n  const[errorEmail, setErrorEmail] = useState('Field can`t be empty')\r\n  const[errorPassword, setErrorPassword] = useState('Field can`t be empty')\r\n  const[formValid, setFormValid] = useState(false)\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const fieldEmail = useRef();\r\n  const[serverError, setServerError] = useState('');\r\n\r\n  const navigate = useNavigate();\r\n\r\n\r\n  useEffect (() => {\r\n    if (errorEmail || errorPassword) {\r\n      setFormValid(false);\r\n    } else {\r\n      setFormValid(true);\r\n    }\r\n  }, [errorEmail, errorPassword])\r\n\r\n\r\n  const emailHandler = (e) => {\r\n    setDirtyEmail(true)\r\n    setEmail(e.target.value)\r\n      const re =\r\n  /^(([^<>()[\\]\\.,;:\\s@\\\"]+(\\.[^<>()[\\]\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@(([^<>()[\\]\\.,;:\\s@\\\"]+\\.)+[^<>()[\\]\\.,;:\\s@\\\"]{2,})$/i;\r\n    if (!e.target.value) {\r\n      setErrorEmail('Field can`t be empty')\r\n    } else if(!re.test(String(e.target.value).toLowerCase())) {\r\n        setErrorEmail('Incorrect email')\r\n    } else {\r\n      setErrorEmail(\"\")\r\n    }\r\n  \r\n  }\r\n\r\n  const passwordHandler = (e) => {\r\n    setDirtyPassword(true)\r\n    setPassword(e.target.value)\r\n    localStorage.setItem(\"password\", e.target.value)\r\n    if (e.target.value.length < 5) {\r\n      setErrorPassword('Make it more than 5')\r\n      if (!e.target.value) {\r\n        setErrorPassword('Field can`t be empty');\r\n      }\r\n    }else{\r\n      setErrorPassword(\"\")\r\n    }\r\n    \r\n  }\r\n\r\n  \r\n\r\n  const handleSubmit = (event) => {\r\n    //Prevent page reload\r\n    event.preventDefault();\r\n\r\n\r\n    setIsLoading(true);\r\n    fetch('http://127.0.0.1:5000/login', {\r\n      method: 'PUT',\r\n      headers: {\r\n        'Content-Type': 'application/json'\r\n      },\r\n      body: JSON.stringify(\r\n        {\r\n          email: email,\r\n          password: password\r\n        }\r\n      )\r\n    })\r\n    .catch(e => {\r\n      throw new Error('Service unreachable')\r\n    })\r\n    .then(response => {\r\n      if (response.headers.get('content-type') == 'application/json') {\r\n        return response.json()\r\n      } else {\r\n        throw new Error(response.statusText)\r\n      }\r\n    })\r\n    .then(jsonResponse => {\r\n      if (jsonResponse.code >=300) {\r\n        throw new Error(jsonResponse.message)\r\n      } else {\r\n        localStorage.setItem(\"id\", jsonResponse.id)\r\n        localStorage.setItem(\"email\", jsonResponse.email)\r\n        setIsLoading(false);\r\n        navigate(\"/homepage\");\r\n      }\r\n    })\r\n    .catch(e => {\r\n      setIsLoading(false);\r\n      setServerError(e.message);  \r\n    });\r\n  };\r\n    \r\n  const renderForm = (\r\n    <div className=\"form\">\r\n        <Form className=\"form-body\" onSubmit={handleSubmit}>\r\n      {/* <form onSubmit={handleSubmit}> */}\r\n        <FormGroup className=\"form__element\">\r\n          <Label className=\"form__label\">Email</Label>\r\n\r\n          <Input invalid= {dirtyEmail && errorEmail} onChange={e => emailHandler(e)}  onBlur={e=>emailHandler(e)} type=\"text\" className=\"form__input\" placeholder = \"Email\" name=\"email\" required ref={fieldEmail}/>\r\n          <FormFeedback invalid style={{width: '30%'}}>{errorEmail}</FormFeedback>\r\n\r\n        </FormGroup>\r\n        <FormGroup className=\"form__element\">\r\n          <Label className=\"form__label\">Password </Label>\r\n          <Input invalid={dirtyPassword && errorPassword} onChange={e=>passwordHandler(e)} onBlur={e=>passwordHandler(e)} type=\"password\" className=\"form__input\" placeholder = \"Password\" name=\"pass\" required />\r\n          <FormFeedback invalid style={{width: '30%'}}>{errorPassword}</FormFeedback>\r\n         \r\n        </FormGroup >\r\n        <div className = \"submitDiv\">\r\n          <button disabled = {!formValid || isLoading} className = \"submitButton\" type=\"submit\">Login</button>\r\n        </div>\r\n        <div className=\"formError\">\r\n             {serverError == '' ? null : <Alert color=\"danger\" style={{width: \"100%\"}} >{serverError}</Alert>}\r\n           </div>\r\n          \r\n      {/* </form> */}\r\n      </Form>\r\n    </div>\r\n  );\r\n    \r\n\r\n    return(\r\n    <div className=\"Login\">\r\n      <div className=\"login-form\">\r\n        <div>{Header(\"Log in\")}</div>\r\n        {isLoading ? <LoadingSpinner />  : renderForm}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}